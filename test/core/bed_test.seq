from bio import *

@test
def test_parse_valid_with_header():
    parser = BED("test/data/valid_with_header.bed", True, False, True)
    first_row_expected = BEDRecord("chr7", 127471196, 127472363, "Pos1", 882.13435, "+", 127471196, 127472363, (255, 0, 0), 4, [11, 12, 13, 14], [14, 55, 66, 99], 12)
    header_expected = ["browser position chr7:127471196-127495720", "browser hide all", "track name=\"ItemRGBDemo\" description=\"Item RGB demonstration\" visibility=2 itemRgb=\"On\""]

    assert header_expected == parser.header
    assert first_row_expected == next(parser)
    parser.close()

@test
def test_parse_invalid_with_header():
    parser = BED("test/data/invalid/invalid_with_header.bed", True, False, True)
    try:
        next(parser)
        parser.close()
    except ValueError as e:
        assert e.message == "chromStart, must be integer, line: 4"
        parser.close()


test_parse_valid_with_header()
test_parse_invalid_with_header()
