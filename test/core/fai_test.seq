from bio import *

@test
def test_parse_valid():
    parser = FAI("test/data/valid_fai.fai", True, False, True)
    first_row_expected = FAIRecord('fastq1', 66, 8, 30, 31, 79)

    assert first_row_expected == next(parser)
    parser.close()


@test
def test_parse_invalid_missing_col():
    parser = FAI("test/data/invalid/invalid_fai_misisng_col.fai", True, False, True)

    try:
        for _ in parser:
            pass
        parser.close()
    except ValueError as e:
        assert e.message == "Line 2 does not have the required number of columns, 6"

@test
def test_parse_invalid_float():
    parser = FAI("../data/invalid/invalid_fai_float_.fai", True, False, True)
    try:
        for _ in parser:
            pass
    except ValueError as e:
        assert e.message == "qual_offset, must be integer, line: 1"

test_parse_valid()
test_parse_invalid_float()
test_parse_invalid_missing_col()