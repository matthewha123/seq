from bio import *

def test_parse_valid_with_header():
    parser = BED("./valid_with_header.bed", True, False, True)
    first_row_expected = BEDRecord("chr7", 127471196, 127472363, "Pos1", 0, "+", 127471196, 127472363, (255, 0, 0), 4, [11, 12, 13, 14], [14, 55, 66, 99], 12)
    header_expected = ["browser position chr7:127471196-127495720", "browser hide all", "track name=\"ItemRGBDemo\" description=\"Item RGB demonstration\" visibility=2 itemRgb=\"On\""]

    assert header_expected == parser.header
    assert first_row_expected == next(parser)

test_parse_valid_with_header()
